# Production Environment Configuration for Django FAQ/RAG Application
# This file contains production-ready environment variables
# Copy this to .env and update the values for your production environment

# =============================================================================
# DJANGO CORE SETTINGS
# =============================================================================

# Django secret key - MUST be changed for production
# Generate a new one at: https://djecrety.ir/
SECRET_KEY=django-insecure-CHANGE-THIS-IN-PRODUCTION-use-djecrety-ir-to-generate

# Environment type
DJANGO_ENV=production

# Debug mode - NEVER set to True in production
DEBUG=False

# Allowed hosts - UPDATE with your actual domain(s)
ALLOWED_HOSTS=localhost,127.0.0.1,your-domain.com,www.your-domain.com

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL Database Settings
DB_NAME=faq_production
DB_USER=faq_user
DB_PASSWORD=CHANGE-THIS-SECURE-PASSWORD
DB_HOST=db
DB_PORT=5432
DB_MAX_CONNECTIONS=20
DB_CONN_MAX_AGE=600

# Database resource limits (for Docker Compose)
DB_MEMORY_LIMIT=512M
DB_CPU_LIMIT=0.5
DB_MEMORY_RESERVATION=256M
DB_CPU_RESERVATION=0.25

# =============================================================================
# SECURITY SETTINGS
# =============================================================================

# HTTPS enforcement - set to True when SSL is configured
SECURE_SSL_REDIRECT=False
SECURE_HSTS_SECONDS=31536000

# CSRF trusted origins - UPDATE with your actual domain(s)
CSRF_TRUSTED_ORIGINS=https://your-domain.com,https://www.your-domain.com

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================

# Gemini AI API Key - REQUIRED for RAG functionality
GEMINI_API_KEY=YOUR-GEMINI-API-KEY-HERE

# =============================================================================
# RAG SYSTEM CONFIGURATION
# =============================================================================

# Embedding configuration
RAG_EMBEDDING_TYPE=local
RAG_LOCAL_EMBEDDING_MODEL=all-MiniLM-L6-v2
RAG_VECTOR_DIMENSION=384
RAG_SIMILARITY_THRESHOLD=0.5
RAG_VECTOR_STORE_TYPE=qdrant
RAG_MAX_RESULTS=10

# Embedding health and fallback configuration
RAG_EMBEDDING_HEALTH_CHECK_INTERVAL=300
RAG_EMBEDDING_FALLBACK_ENABLED=true
RAG_TEXT_SEARCH_FALLBACK_ENABLED=true
RAG_EMBEDDING_RETRY_ATTEMPTS=3
RAG_EMBEDDING_RETRY_DELAY=1.0

# =============================================================================
# VECTOR DATABASE (QDRANT) CONFIGURATION
# =============================================================================

# Qdrant connection settings
QDRANT_HOST=qdrant
QDRANT_PORT=6333
QDRANT_COLLECTION_NAME=faq_embeddings
QDRANT_TIMEOUT=30
QDRANT_VERSION=latest

# Qdrant performance settings
QDRANT_LOG_LEVEL=INFO
QDRANT_MAX_REQUEST_SIZE=32
QDRANT_MAX_SEARCH_THREADS=0

# Qdrant resource limits (for Docker Compose)
QDRANT_MEMORY_LIMIT=1G
QDRANT_CPU_LIMIT=1.0
QDRANT_MEMORY_RESERVATION=512M
QDRANT_CPU_RESERVATION=0.5
QDRANT_HTTP_PORT=6333
QDRANT_GRPC_PORT=6334

# =============================================================================
# CACHE CONFIGURATION (REDIS)
# =============================================================================

# Redis connection settings
REDIS_URL=redis://redis:6379/0
REDIS_VERSION=7-alpine
REDIS_PASSWORD=
CACHE_TTL=3600

# Redis resource limits (for Docker Compose)
REDIS_MEMORY_LIMIT=256M
REDIS_CPU_LIMIT=0.5
REDIS_MEMORY_RESERVATION=128M
REDIS_CPU_RESERVATION=0.25

# =============================================================================
# APPLICATION SERVER (GUNICORN) CONFIGURATION
# =============================================================================

# Gunicorn worker settings - adjust based on your server specs
GUNICORN_WORKERS=4
GUNICORN_WORKER_CLASS=sync
GUNICORN_MAX_REQUESTS=1000
GUNICORN_MAX_REQUESTS_JITTER=100
GUNICORN_TIMEOUT=30
GUNICORN_LOG_LEVEL=info
GUNICORN_WORKER_MEMORY_LIMIT=536870912  # 512MB in bytes

# Application resource limits (for Docker Compose)
APP_MEMORY_LIMIT=1G
APP_CPU_LIMIT=1.0
APP_MEMORY_RESERVATION=512M
APP_CPU_RESERVATION=0.5
APP_EXTERNAL_PORT=8000

# =============================================================================
# WEB SERVER (NGINX) CONFIGURATION
# =============================================================================

# Nginx version and ports
NGINX_VERSION=alpine
HTTP_PORT=80
HTTPS_PORT=443

# Nginx performance settings
NGINX_WORKER_PROCESSES=auto
NGINX_WORKER_CONNECTIONS=1024
NGINX_CLIENT_MAX_BODY_SIZE=10M

# Nginx resource limits (for Docker Compose)
NGINX_MEMORY_LIMIT=256M
NGINX_CPU_LIMIT=0.5
NGINX_MEMORY_RESERVATION=128M
NGINX_CPU_RESERVATION=0.25

# =============================================================================
# DOCKER COMPOSE NETWORKING
# =============================================================================

# Network subnets
FRONTEND_SUBNET=172.20.0.0/16
BACKEND_SUBNET=172.21.0.0/16

# =============================================================================
# DATA PERSISTENCE PATHS
# =============================================================================

# Data directory paths (relative to docker-compose.yml)
POSTGRES_DATA_PATH=./data/postgres
QDRANT_DATA_PATH=./data/qdrant
REDIS_DATA_PATH=./data/redis
APP_LOGS_PATH=./logs
NGINX_LOGS_PATH=./logs/nginx

# =============================================================================
# MONITORING AND LOGGING
# =============================================================================

# Logging configuration
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_MAX_SIZE=100MB
LOG_BACKUP_COUNT=10

# Error tracking (optional)
SENTRY_DSN=

# Monitoring settings
HEALTH_CHECK_INTERVAL=300  # 5 minutes in seconds
RESOURCE_CHECK_INTERVAL=600  # 10 minutes in seconds
LOG_ANALYSIS_INTERVAL=3600  # 1 hour in seconds

# Alert thresholds
CPU_THRESHOLD=80
MEMORY_THRESHOLD=85
DISK_THRESHOLD=90
RESPONSE_TIME_THRESHOLD=5000  # milliseconds
ALERT_COOLDOWN=1800  # 30 minutes in seconds

# Backup configuration
BACKUP_RETENTION_DAYS=30
BACKUP_COMPRESSION=true
BACKUP_SCHEDULE="0 3 * * *"  # Daily at 3 AM

# =============================================================================
# EMAIL CONFIGURATION (OPTIONAL)
# =============================================================================

# Email backend for error notifications
EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend
EMAIL_HOST=
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=
EMAIL_HOST_PASSWORD=
DEFAULT_FROM_EMAIL=noreply@your-domain.com
ADMIN_EMAIL=admin@your-domain.com

# =============================================================================
# PERFORMANCE SETTINGS
# =============================================================================

# File upload limits (in bytes)
DATA_UPLOAD_MAX_MEMORY_SIZE=5242880  # 5MB
FILE_UPLOAD_MAX_MEMORY_SIZE=2621440  # 2.5MB